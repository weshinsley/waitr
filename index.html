<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slightly More Precise Delays for Animations • waitr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Slightly More Precise Delays for Animations">
<meta property="og:description" content="Wait for (delay), or wait until (time).
    Intended as a more precise version of Sys.sleep(),
    which seems to have a slight overheard, such that Sys.sleep(0.01)
    behaves about the same as Sys.sleep(0.02), but removing
    the Sys.sleep altogether makes much more of a difference.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">waitr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/weshinsley/waitr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="waitr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#waitr" class="anchor"></a>waitr</h1></div>
<p>An R package which does nothing, and takes a number of millliseconds doing it. It wraps C date-time functions to provide a faster type of Sys.sleep() call, keeping its own relative time. You can wait <em>for</em> a number of milliseconds, or wait _until a number of milliseconds have elapsed since a reference point.</p>
<p>The timing is not intended to be very precise, but is good enough for maintaing an approximate frame-rate, allowind animations to look more or less the same on different computers and platforms.</p>
<p>Sys.sleep() I found could not always do this, especially for very small delays, on older or slower machines. On these cases, Sys.sleep(0.01) or less, seemed to consistently cause very slow frame rates, whereas removing the Sys.sleep entirely showed the computer well able to exceed the framerate I wanted if left in freefall.</p>
<!-- badges: start -->
<p><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://github.com/weshinsley/waitr/actions"><img src="https://github.com/weshinsley/waitr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://codecov.io/github/weshinsley/waitr?branch=v1"><img src="https://codecov.io/github/weshinsley/waitr/coverage.svg?branch=v1" alt="codecov.io"></a> <!-- badges: end --></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"weshinsley/waitr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Reset the internal clock to zero as follows. This will happen automatically on the first call to any waitr function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">&gt;</span><span class="st"> </span>waitr<span class="op">::</span><span class="kw">waitr_reset</span>()</span>
<span id="cb2-2"><a href="#cb2-2"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
<p>A delay might look like this.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">system.time</span>(waitr<span class="op">::</span><span class="kw">waitr_delay</span>(<span class="dv">500</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a>   user  system elapsed </span>
<span id="cb3-3"><a href="#cb3-3"></a>   <span class="fl">0.00</span>    <span class="fl">0.00</span>    <span class="fl">0.51</span> </span></code></pre></div>
<p>And here is a delay until a certain relative time - which will be a short delay if that time has already elapsed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>x &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  t &lt;-<span class="st"> </span>waitr<span class="op">::</span><span class="kw">waitr_reset</span>()</span>
<span id="cb4-3"><a href="#cb4-3"></a>  t1 &lt;-<span class="st"> </span><span class="kw">system.time</span>(waitr<span class="op">::</span><span class="kw">wait_until</span>(<span class="dv">1000</span>))[[<span class="st">'elapsed'</span>]]</span>
<span id="cb4-4"><a href="#cb4-4"></a>  t2 &lt;-<span class="st"> </span><span class="kw">system.time</span>(waitr<span class="op">::</span><span class="kw">wait_until</span>(<span class="dv">500</span>))[[<span class="st">'elapsed'</span>]]</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="kw">c</span>(t1, t2)</span>
<span id="cb4-6"><a href="#cb4-6"></a>}</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">x</span>()</span>
<span id="cb4-9"><a href="#cb4-9"></a>[<span class="dv">1</span>] <span class="fl">0.89</span> <span class="fl">0.00</span></span></code></pre></div>
<p>The 0.89 is less than the second we hoped for, because of the overheads in R of calling <code>system.time</code> in that way. But the key point is that the second call finishes very quickly when the time has elapsed. You can therefore write code that aims for an average framerate, catching up where it can, with something in the form:-</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">next_frame</span> <span class="op">&lt;-</span> <span class="fu">waitr</span><span class="fu">::</span><span class="fu"><a href="reference/wait_for.html">waitr_timestamp</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span>
  <span class="kw">while</span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Do the work for the frame</span>
    <span class="va">next_frame</span> <span class="op">&lt;-</span> <span class="fu">waitr</span><span class="fu">::</span><span class="fu"><a href="reference/wait_for.html">wait_until</a></span><span class="op">(</span><span class="va">next_frame</span> <span class="op">+</span> <span class="fl">10</span><span class="op">)</span>
  <span class="op">}</span></code></pre></div>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>MIT © <a href="https://github.com/weshinsley">Wes Hinsley</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/weshinsley/waitr/">https://​github.com/​weshinsley/​waitr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/weshinsley/waitr">https://​github.com/​weshinsley/​waitr</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Wes Hinsley <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
